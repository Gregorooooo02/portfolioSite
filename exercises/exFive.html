<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Exercise 5</title>

    <link rel="stylesheet" href="../stylesheet.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Silkscreen&display=swap"
          rel="stylesheet">

</head>
<body>
    <nav class="navbar">
        <ul class="navbar-nav">
            <li class="logo">
                <a href="../index.html" class="nav-link">
                    <span class="link-text">Technologie XML</span>
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 512 512" fill="blueviolet"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                        <path d="M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"/>
                    </svg>
                </a>
            </li>

            <li class="nav-item">
                <a href="exOne.html" class="nav-link">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 640 512" fill="blueviolet"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                        <path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3L562.7 256l-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/>
                    </svg>
                    <span class="link-text">Zadanie 1</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="exTwo.html" class="nav-link">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 512 512" fill="blueviolet"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                        <path d="M432 64H208c-8.8 0-16 7.2-16 16V96H128V80c0-44.2 35.8-80 80-80H432c44.2 0 80 35.8 80 80V304c0 44.2-35.8 80-80 80H416V320h16c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16zM0 192c0-35.3 28.7-64 64-64H320c35.3 0 64 28.7 64 64V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V192zm64 32c0 17.7 14.3 32 32 32H288c17.7 0 32-14.3 32-32s-14.3-32-32-32H96c-17.7 0-32 14.3-32 32z"/>
                    </svg>
                    <span class="link-text">Zadanie 2</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="exThree.html" class="nav-link">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 576 512" fill="blueviolet"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                        <path d="M88.7 223.8L0 375.8V96C0 60.7 28.7 32 64 32H181.5c17 0 33.3 6.7 45.3 18.7l26.5 26.5c12 12 28.3 18.7 45.3 18.7H416c35.3 0 64 28.7 64 64v32H144c-22.8 0-43.8 12.1-55.3 31.8zm27.6 16.1C122.1 230 132.6 224 144 224H544c11.5 0 22 6.1 27.7 16.1s5.7 22.2-.1 32.1l-112 192C453.9 474 443.4 480 432 480H32c-11.5 0-22-6.1-27.7-16.1s-5.7-22.2 .1-32.1l112-192z"/>
                    </svg>
                    <span class="link-text">Zadanie 3</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="exFour.html" class="nav-link">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 640 512" fill="blueviolet"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                        <path d="M192 64C86 64 0 150 0 256S86 448 192 448H448c106 0 192-86 192-192s-86-192-192-192H192zM496 248c-22.1 0-40-17.9-40-40s17.9-40 40-40s40 17.9 40 40s-17.9 40-40 40zm-24 56c0 22.1-17.9 40-40 40s-40-17.9-40-40s17.9-40 40-40s40 17.9 40 40zM168 200c0-13.3 10.7-24 24-24s24 10.7 24 24v32h32c13.3 0 24 10.7 24 24s-10.7 24-24 24H216v32c0 13.3-10.7 24-24 24s-24-10.7-24-24V280H136c-13.3 0-24-10.7-24-24s10.7-24 24-24h32V200z"/>
                    </svg>
                    <span class="link-text">Zadanie 4</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="#" class="nav-link">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 384 512" fill="blueviolet"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                        <path d="M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM153 289l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0L71 337c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zM265 255l48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"/>
                    </svg>
                    <span class="link-text">Zadanie 5</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="#" class="nav-link">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 512 512" fill="blueviolet"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                        <path d="M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0S0 114.6 0 256S114.6 512 256 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24V250.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1H222.6c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM288 352c0 17.7-14.3 32-32 32s-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32z"/>
                    </svg>
                    <span class="link-text">Informacje</span>
                </a>
            </li>
        </ul>
    </nav>

    <main class="exFive">
        <div class="heading">
            <h1>Zadanie 5</h1>
        </div>
        <p>
            Należy stworzyć stronę internetową z wykorzystaniem JavaScript (DOM) umożliwiającą dostęp do danych z pliku XML,
            modyfikowanie danych z pliku XML, sprawdzanie poprawności modyfikowanych danych.
        </p>
        <p>
            Program ma być interaktywny i umożliwiać otwarcie pliku XML o z góry założonej strukturze,
            dodawanie do niego nowych wpisów, usuwanie i edycję istniejących.
        </p>
        <hr class="rounded"/>
        <div class="heading">
            <h2>Rozwiązanie</h2>
        </div>
        <button class="accordion">Plik HTML</button>
        <div class="accordionPanel codeBox">
            <pre>
                <code>
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Zadanie 5&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;stylesheet.css&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=&quot;heading&quot;&gt;
        &lt;h1&gt;Technologie XML&lt;/h1&gt;
        &lt;h2&gt;Zadanie 5&lt;/h2&gt;
    &lt;/div&gt;
    &lt;div id=&quot;chooseFileSchema&quot;&gt;
        &lt;label for=&quot;fileSchema&quot;&gt;Wybierz plik XML Schema&lt;/label&gt;
        &lt;input type=&quot;file&quot; accept=&quot;.xsd&quot; id=&quot;fileSchemaInput&quot; name=&quot;fileSchema&quot;&gt;
        &lt;button id=&quot;fileSchemaSubmit&quot;&gt;Wczytaj&lt;/button&gt;
        &lt;p id=&quot;currentSchema&quot;&gt;&lt;/p&gt;
    &lt;/div&gt;

    &lt;div hidden=&quot;&quot; id=&quot;chooseFileXML&quot;&gt;
        &lt;label for=&quot;fileXML&quot;&gt;Wybierz plik XML&lt;/label&gt;
        &lt;input type=&quot;file&quot; accept=&quot;text/xml&quot; id=&quot;fileXMLInput&quot; name=&quot;fileXML&quot;&gt;
        &lt;button id=&quot;fileXMLSubmit&quot;&gt;Wczytaj&lt;/button&gt;
        &lt;p id=&quot;currentXML&quot;&gt;&lt;/p&gt;
    &lt;/div&gt;

    &lt;a id=&quot;downloadFile&quot; href=&quot;&quot; download=&quot;plytoteka.xml&quot;&gt;Pobierz plik&lt;/a&gt;
    &lt;div id=&quot;fileContents&quot;&gt;&lt;/div&gt;

    &lt;h2&gt;Płyty&lt;/h2&gt;
    &lt;div id=&quot;disks&quot;&gt;

    &lt;/div&gt;

    &lt;h2&gt;Gatunki&lt;/h2&gt;
    &lt;table id=&quot;genreTable&quot; hidden=&quot;&quot;&gt;
        &lt;tr&gt;
            &lt;th&gt;Nazwa gatunku&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/table&gt;

    &lt;h2&gt;Studenci&lt;/h2&gt;
    &lt;table id=&quot;studentTable&quot; hidden=&quot;&quot;&gt;
        &lt;tr&gt;
            &lt;th&gt;ID studenta&lt;/th&gt;
            &lt;th&gt;Imię i nazwisko&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;script src=&quot;script.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;xmllint.js&quot;&gt;&lt;/script&gt;
&lt;/html&gt;
                </code>
            </pre>
        </div>
        <button class="accordion">Plik JavaScript</button>
        <div class="accordionPanel codeBox">
            <pre>
                <code>
const chooseXML = document.getElementById(&quot;chooseFileXML&quot;);
const fileXML = document.getElementById(&quot;fileXMLInput&quot;);
const currentXML = document.getElementById(&quot;currentXML&quot;);
const fileXMLSubmitButton = document.getElementById(&quot;fileXMLSubmit&quot;);

const fileSchema = document.getElementById(&quot;fileSchemaInput&quot;);
const currentSchema = document.getElementById(&quot;currentSchema&quot;);
const fileSchemaSubmitButton = document.getElementById(&quot;fileSchemaSubmit&quot;);

const fileDownload = document.getElementById(&quot;downloadFile&quot;);
const serializerXML = new XMLSerializer();

let submittedXML = &quot;&quot;;

var xmlDoc;
var schemaContent = &quot;&quot;;
var emptyDisk = null;
var emptyGenre = null;
var emptyStudent = null;

currentXML.textContent = &quot;Wczytany plik: Brak&quot;;
currentSchema.textContent = &quot;Wczytany plik: Brak&quot;;

fileXMLSubmitButton.onclick = function () {
    console.log(&quot;Starting XML file loader.&quot;);
    const file = fileXML.files[0];

    if (!file)
        return;

    let reader = new FileReader();
    reader.readAsText(file, &quot;UTF-8&quot;);

    reader.onload = function (evt) {
        let xmlContent = evt.target.result;
        fileDownload.href = makeTextFile(xmlContent);

        let parser = new DOMParser();
        xmlDoc = parser.parseFromString(xmlContent, &quot;text/xml&quot;);
        currentXML.textContent = &quot;Wczytany plik: &quot; + fileXML.files[0].name;
        onFileLoaded();
    }

    reader.onerror = function (evt) {
        console.log(&quot;Error - cannot read file.&quot;)
    }

    console.log(&quot;XML file loaded!&quot;);
}

fileSchemaSubmitButton.onclick = function () {
    console.log(&quot;Starting Schema file loader.&quot;);
    const file = fileSchema.files[0];

    if (!file)
        return;

    let reader = new FileReader();
    reader.readAsText(file, &quot;UTF-8&quot;);

    reader.onload = function (evt) {
        schemaContent = evt.target.result;
        chooseXML.removeAttribute(&quot;hidden&quot;);
        currentSchema.textContent = &quot;Wczytany plik: &quot; + fileSchema.files[0].name;
    }

    console.log(&quot;Schema file loaded!&quot;);
}

// Methods section

function onFileLoaded() {
    // Checks whether there are any disks, genres or students in file.
    if (xmlDoc.getElementsByTagName(&quot;disk&quot;).length != 0)
        emptyDisk = createEmptyDisk(xmlDoc.getElementsByTagName(&quot;disk&quot;)[0]);

    updateLastDiskID(emptyDisk);

    const disksDiv = document.getElementById(&quot;disks&quot;);
    let disksGenerated = document.getElementById(&quot;disksGenerated&quot;);

    if (disksGenerated != null) {
        disksGenerated.remove();
    }

    disksGenerated = document.createElement(&quot;disksGenerated&quot;);
    disksGenerated.setAttribute(&quot;id&quot;, &quot;disksGenerated&quot;);

    disksDiv.append(disksGenerated);

    let allGenresIDs = [];
    for (let element of xmlDoc.getElementsByTagName(&quot;genre&quot;)) {
        allGenresIDs.push(element.getAttribute(&quot;genreId&quot;));
    }

    let allStudentsIDs = [];
    for (let element of xmlDoc.getElementsByTagName(&quot;student&quot;)) {
        allStudentsIDs.push(element.getAttribute(&quot;studentId&quot;));
    }

    let allDisks = [];
    for (let element of xmlDoc.getElementsByTagName(&quot;disk&quot;)) {
        allDisks.push(element);
    }

    for (let element of xmlDoc.getElementsByTagName(&quot;disk&quot;)) {
        const newRowLabels = document.createElement(&quot;tr&quot;);
        const newRow = document.createElement(&quot;tr&quot;);
        let childIndex = 0;

        createLabelColumn(newRowLabels, &quot;ID płyty&quot;);
        const diskIDAttr = element.getAttributeNode(&quot;id&quot;);
        const diskID = createTextInputFromAttribute(diskIDAttr);
        createContentColumn(newRow, diskID);

        createLabelColumn(newRowLabels, &quot;Gatunek&quot;);
        const diskGenreIDAttr = element.getAttributeNode(&quot;genreId&quot;);
        const diskGenreID = createSelectFromAttribute(diskGenreIDAttr, allGenresIDs, diskGenreIDAttr.value);
        createContentColumn(newRow, diskGenreID);

        createLabelColumn(newRowLabels, &quot;Ulubiona&quot;);
        const diskStudentIDAttr = element.getAttributeNode(&quot;favorite&quot;);
        const diskStudentID = createSelectFromAttribute(diskStudentIDAttr, allStudentsIDs, diskStudentIDAttr.value);
        createContentColumn(newRow, diskStudentID);

        createLabelColumn(newRowLabels, &quot;Autor&quot;);
        const diskAuthor = createTextInputFromElement(element.children[childIndex]);
        createContentColumn(newRow, diskAuthor);
        childIndex++;

        createLabelColumn(newRowLabels, &quot;Tytuł&quot;);
        const diskTitle = createTextInputFromElement(element.children[childIndex]);
        createContentColumn(newRow, diskTitle);
        childIndex++;

        createLabelColumn(newRowLabels, &quot;Data wydania&quot;);
        const diskReleased = createTextInputFromElement(element.children[childIndex]);
        createContentColumn(newRow, diskReleased);
        childIndex++;

        createLabelColumn(newRowLabels, &quot;Ilość piosenek&quot;);
        const diskSongs = createTextInputFromElement(element.children[childIndex]);
        createContentColumn(newRow, diskSongs);
        childIndex++;

        createLabelColumn(newRowLabels, &quot;Długość&quot;);
        const diskLength = createTextInputFromElement(element.children[childIndex]);
        createContentColumn(newRow, diskLength);
        childIndex++;

        createLabelColumn(newRowLabels, &quot;Cena&quot;);
        const diskPrice = createTextInputFromElement(element.children[childIndex]);
        createContentColumn(newRow, diskPrice);
        childIndex++;

        createLabelColumn(newRowLabels, &quot;Ocena&quot;);
        const diskRating = createTextInputFromElement(element.children[childIndex]);
        createContentColumn(newRow, diskRating);
        childIndex++;

        createLabelColumn(newRowLabels, &quot;Usuń płytę&quot;);
        const deleteButton = createDeleteButton([newRow, element], null);
        createContentColumn(newRow, deleteButton);

        disksGenerated.append(newRowLabels);
        disksGenerated.append(newRow);
        disksGenerated.append(document.createElement(&quot;br&quot;));
        disksGenerated.append(document.createElement(&quot;hr&quot;));
        disksGenerated.append(document.createElement(&quot;br&quot;));
    }

    {
        const newRowLabels = document.createElement(&quot;tr&quot;);
        const newRow = document.createElement(&quot;tr&quot;);

        createLabelColumn(newRowLabels, &quot;Dodaj płytę&quot;);
        const addButton = createAddButton(emptyDisk, xmlDoc.getElementsByTagName(&quot;disks&quot;)[0], &quot;&quot;);
        createContentColumn(newRow, addButton);

        disksGenerated.append(newRowLabels);
        disksGenerated.append(newRow);
        disksGenerated.append(document.createElement(&quot;br&quot;));
        disksGenerated.append(document.createElement(&quot;hr&quot;));
        disksGenerated.append(document.createElement(&quot;br&quot;));
    }

    const genreTable = document.getElementById(&quot;genreTable&quot;);
    const genreElements = xmlDoc.getElementsByTagName(&quot;genre&quot;);
    genreTable.removeAttribute(&quot;hidden&quot;);

    for (let element of genreElements) {
        let genreName = element.textContent;
        let newRow = document.createElement(&quot;tr&quot;);

        newRow.innerHTML = &quot;&lt;td&gt;&quot; + genreName + &quot;&lt;/td&gt;&quot;;
        genreTable.appendChild(newRow);
    }

    const studentTable = document.getElementById(&quot;studentTable&quot;);
    const studentElements = xmlDoc.getElementsByTagName(&quot;student&quot;);
    studentTable.removeAttribute(&quot;hidden&quot;);

    for (let element of studentElements) {
        let studentID = element.getAttribute(&quot;studentId&quot;);
        let studentName = element.textContent;
        let newRow = document.createElement(&quot;tr&quot;);

        newRow.innerHTML = &quot;&lt;td&gt;&quot; + studentID + &quot;&lt;/td&gt;&quot; +
            &quot;&lt;td&gt;&quot; + studentName + &quot;&lt;/td&gt;&quot;;
        studentTable.appendChild(newRow);
    }
}

function createLabelColumn(labelParent, label) {
    const labelElement = document.createElement(&quot;label&quot;);
    labelElement.textContent = label;

    let labelTh = document.createElement(&quot;th&quot;);
    labelTh.appendChild(labelElement);
    labelParent.appendChild(labelTh);
}

function createContentColumn(contentParent, content) {
    let contentTh = document.createElement(&quot;th&quot;);
    contentTh.append(content);
    contentParent.appendChild(contentTh);
}

function createTextInputFromElement(element) {
    let input = document.createElement(&quot;input&quot;);
    input.type = &quot;text&quot;;
    input.value = element.textContent;

    let oldValue = { str: element.textContent };
    input.onchange = function () {
        validateAndAssignXMLElement(element, input, oldValue);
    };

    return input;
}

function createTextInputFromAttribute(attribute) {
    let input = document.createElement(&quot;input&quot;);
    input.type = &quot;text&quot;;
    input.value = attribute.value;

    let oldValue = { str: attribute.value };
    input.onchange = function () {
        validateAndAssignXMLAttribute(attribute, input, oldValue);
    };

    return input;
}

function createSelectFromAttribute(attribute, optionList, defaultValue) {
    const select = document.createElement(&quot;select&quot;);

    for (option of optionList) {
        let optionElement = document.createElement(&quot;option&quot;);
        if (option == defaultValue) {
            optionElement.setAttribute(&quot;selected&quot;, &quot;&quot;);
        }
        optionElement.value = option;
        optionElement.textContent = option;
        select.appendChild(optionElement);
    }

    select.onchange = function () {
        attribute.value = select.value;
        onXMLChanged();
    };

    return select;
}

function createDeleteButton(elementToDelete, optionalElementsToDelete) {
    const deleteButton = document.createElement(&quot;button&quot;);
    deleteButton.type = &quot;button&quot;;
    deleteButton.textContent = &quot;Usuń &quot;;

    const deleteIcon = document.createElement(&quot;img&quot;);
    deleteIcon.src = &quot;./icons/trash.png&quot;;
    deleteIcon.width = 10;
    deleteIcon.height = 10;
    deleteButton.appendChild(deleteIcon);

    deleteButton.onclick = function () {
        elementToDelete.forEach(element =&gt; {
            element.remove();
        });

        console.log(optionalElementsToDelete);
        if (optionalElementsToDelete != null) {
            const response = confirm(&quot;Czy usunąć też powiązane elementy?&quot;);
            if (response) {
                optionalElementsToDelete.forEach(element =&gt; {
                    element.remove();
                })
            }
        }

        onXMLChanged();
    }

    return deleteButton;
}

function createAddButton(elementToAdd, xmlParentElement, insertBefore) {
    const addButton = document.createElement(&quot;button&quot;);
    addButton.type = &quot;button&quot;;
    addButton.textContent = &quot;Dodaj &quot;;

    const plusIcon = document.createElement(&quot;img&quot;);
    plusIcon.src = &quot;./icons/plus.png&quot;;
    plusIcon.width = 10;
    plusIcon.height = 10;
    addButton.appendChild(plusIcon);

    addButton.onclick = function () {
        if (insertBefore == &quot;&quot;) {
            xmlParentElement.append(elementToAdd.cloneNode(true));
        }
        else {
            let objectToPutBeforeFound = false;
            for (obj of xmlParentElement.children) {
                if (obj.localName == insertBefore) {
                    objectToPutBeforeFound = true;
                }
                else if (objectToPutBeforeFound) {
                    xmlParentElement.insertBefore(elementToAdd.cloneNode(true), obj);
                    xmlParentElement.insertBefore(xmlDoc.createTextNode(&quot; &quot;), obj);
                    break;
                }
            }
        }

        onXMLChanged();
    }

    return addButton;
}

function createEmptyDisk(disk) {
    let diskClone = disk.cloneNode(true);

    diskClone.getElementsByTagName(&quot;author&quot;)[0].textContent = &quot;Autor&quot;;
    diskClone.getElementsByTagName(&quot;title&quot;)[0].textContent = &quot;Tytuł&quot;;
    diskClone.getElementsByTagName(&quot;released&quot;)[0].textContent = &quot;00/00/0000&quot;;
    diskClone.getElementsByTagName(&quot;howManySongs&quot;)[0].textContent = &quot;1&quot;;
    diskClone.getElementsByTagName(&quot;length&quot;)[0].textContent = &quot;0:00&quot;;
    diskClone.getElementsByTagName(&quot;price&quot;)[0].textContent = &quot;1.00&quot;;
    diskClone.getElementsByTagName(&quot;ratings&quot;)[0].textContent = &quot;1.0&quot;;

    return diskClone;
}

function updateLastDiskID(disk) {
    disk.setAttribute(&quot;id&quot;, calculateLastID(&quot;disk&quot;, &quot;id&quot;, &quot;D&quot;, 2));
    if (xmlDoc.getElementsByTagName(&quot;student&quot;).length == 0)
        disk.setAttribute(&quot;favorite&quot;, &quot;&quot;);
    else
        disk.setAttribute(&quot;favorite&quot;, xmlDoc.getElementsByTagName(&quot;student&quot;)[0].getAttribute(&quot;studentId&quot;));
}

function updateLastGenreID(genre) {
    genre.setAttribute(&quot;genreId&quot;, genre.getElementsByTagName(&quot;genre&quot;)[0].value);
}

function updateLastStudentID(student) {
    student.setAttribute(&quot;studentId&quot;, calculateLastID(&quot;student&quot;, &quot;studentId&quot;, &quot;S&quot;, 2));
}

function calculateLastID(elementTag, idName, charsBeforeNumbers, numberOfChars) {
    let newIDNumber = 1;
    let idFound = false;
    let newID = &quot;&quot;;
    const allElements = xmlDoc.getElementsByTagName(elementTag);

    while(!idFound) {
        let potentialID = charsBeforeNumbers;

        for (let i = 0; i &lt; (numberOfChars - charsBeforeNumbers.length - newIDNumber.toString().length); i++) {
            potentialID += &quot;0&quot;;
        }
        potentialID += newIDNumber.toString();

        idFound = true;

        for(let i = 0; i &lt; allElements.length; i++) {
            if (potentialID == allElements[i].getAttribute(idName)) {
                idFound = false;
                break;
            }
        }

        newID = potentialID;
        newIDNumber++;
    }

    return newID;
}

function validateAndAssignXMLElement(XMLElement, input, oldValue) {
    XMLElement.textContent = input.value;

    if (xmllint.validateXML({xml: serializerXML.serializeToString(xmlDoc), schema: schemaContent}).errors) {
        console.log(xmllint.validateXML({xml: serializerXML.serializeToString(xmlDoc), schema: schemaContent}));

        XMLElement.textContent = oldValue.str;
        input.value = oldValue.str;

        return;
    }

    oldValue.str = input.value;
    onXMLChanged();
}

function validateAndAssignXMLAttribute(XMLAttribute, input, oldValue) {
    XMLAttribute.textContent = input.value;

    if (xmllint.validateXML({xml: serializerXML.serializeToString(xmlDoc), schema: schemaContent}).errors) {
        console.log(xmllint.validateXML({xml: serializerXML.serializeToString(xmlDoc), schema: schemaContent}));

        XMLAttribute.textContent = oldValue.str;
        input.value = oldValue.str;

        return;
    }

    oldValue.str = input.value;
    onXMLChanged();
}

function makeTextFile(text) {
    let data = new Blob([text], {type: &apos;text/xml&apos;});
    return window.URL.createObjectURL(data);
}

function onXMLChanged() {
    let XML = serializerXML.serializeToString(xmlDoc);
    fileDownload.href = makeTextFile(XML);
    onFileLoaded();
}
                </code>
            </pre>
        </div>
        <button class="accordion">Plik stylów CSS</button>
        <div class="accordionPanel codeBox">
            <pre>
                <code>
body {
    font-family: Helvetica, monospace;
    color: white;
    background-color: blueviolet;
}

.heading {
    text-align: center;
}

label {
    display: block;
    font-size: 20px;
    font-weight: bold;
    padding-bottom: 7px;
}

#chooseFileSchema {
    text-align: center;
}

#chooseFileXML {
    text-align: center;
}

#downloadFile {
    text-align: center;
    margin-left: 38em;
    font-size: 20px;
    font-weight: bold;
    color: white;
}

h2 {
    text-align: center;
}
                </code>
            </pre>
        </div>
        <script>
            let accordion = document.getElementsByClassName("accordion");
            let i;

            for (i = 0; i < accordion.length; ++i) {
                accordion[i].addEventListener("click", function() {
                    this.classList.toggle("active");
                    let panel = this.nextElementSibling;

                    if (panel.style.maxHeight) {
                        panel.style.maxHeight = null;
                    }
                    else {
                        panel.style.maxHeight = panel.scrollHeight + "px";
                    }
                });
            }
        </script>
        <br/>
        <button class="exerciseLink">
            <a class="exerciseLink" href="../exercisesFiles/exercise5/index.html" target="download">Sprawdź zadanie!</a>
        </button>
    </main>
</body>
</html>